( ps -p $$ | grep -q bash ) || ( echo "You must use Bash" ; return 1 ; exit 1 )

if [ "${BASH_SOURCE[0]}" -ef "$0" ] ; then
    echo "You must source \"${BASH_SOURCE[0]}\". Do not execute it"
    exit 1
fi

if [ $(python3 --version | cut -d ' ' -f 2 | cut -d '.' -f 2) -lt 8 ] ; then
  echo "You must use Python 3.8 or greater"
  return 1
fi

if [ -z "$VENV_DIR" ] ; then
  VENV_DIR="venv"
fi

if [ -z "$VIRTUAL_ENV" ] ; then
  if [ ! -f $VENV_DIR/bin/activate ] ; then
    /bin/rm -rf $VENV_DIR
    python3 -m venv $VENV_DIR
    . $VENV_DIR/bin/activate
    python3 -m pip install --upgrade --requirement requirements.txt
  else
    . $VENV_DIR/bin/activate
  fi
fi
